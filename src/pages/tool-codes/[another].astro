---
import ToolCodeLayout from "@/layouts/ToolCodeLayout/index.astro";
import { fetchCodes, fetchTitle } from "@/utils/fetchCodes";

export async function getStaticPaths() {
  const all = await fetchCodes();
  const titles = await fetchTitle();
  const exists = (await Astro.glob("./*.{md,mdx}")).map(({ url }) =>
    url.split("/").at(-1)
  );

  const paths = Object.keys(all)
    .filter((page) => !exists.includes(page))
    .map((page) => {
      return {
        params: { another: page },
        props: {
          frontmatter: {
            title: titles[page],
            url: page,
          },
        },
      };
    });

  return paths;
}

const { frontmatter } = Astro.props;
---

<ToolCodeLayout frontmatter={frontmatter} />
